<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Communications ATC - VFR Radio Phrase Guide</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 20px auto;
    padding: 10px;
    background: #f0f4f8;
    color: #222;
  }
  h1 {
    text-align: center;
    color: #dc3545;
  }
  .lang-switch {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-bottom: 16px;
  }
  .lang-switch button {
    background: #fce8e6;
    color: #dc3545;
    border: 1px solid #dc3545;
    border-radius: 4px;
    padding: 6px 14px;
    font-weight: bold;
    cursor: pointer;
  }
  .lang-switch button.active {
    background: #dc3545;
    color: #fff;
  }
  .options-switch {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-bottom: 16px;
  }
  .options-switch button {
    background: #fce8e6;
    color: #dc3545;
    border: 1px solid #dc3545;
    border-radius: 4px;
    padding: 6px 14px;
    font-weight: bold;
    cursor: pointer;
  }
  .options-switch button.active {
    background: #dc3545;
    color: #fff;
  }
  .back-button {
    display: inline-block;
    margin-bottom: 20px;
    background: #6c757d;
    color: white;
    text-decoration: none;
    padding: 8px 16px;
    border-radius: 4px;
    font-weight: bold;
  }
  .back-button:hover {
    background: #5a6268;
  }
  label {
    display: block;
    margin-top: 12px;
    font-weight: bold;
  }
  input, select {
    width: 100%;
    padding: 8px;
    margin-top: 4px;
    font-size: 1rem;
    border: 1px solid #bbb;
    border-radius: 4px;
  }
  button[type="submit"] {
    margin-top: 20px;
    background-color: #dc3545;
    color: white;
    border: none;
    padding: 12px 20px;
    font-size: 1.1rem;
    border-radius: 5px;
    cursor: pointer;
  }
  button[type="submit"]:hover {
    background-color: #c82333;
  }
  .phrase {
    background: #fce8e6;
    color: #721c24;
    font-weight: bold;
    padding: 8px 10px;
    border-radius: 4px;
    margin-bottom: 8px;
    display: block;
  }
  details {
    margin-bottom: 12px;
    background: #fff;
    border: 1px solid #f8d7da;
    border-radius: 4px;
    padding: 6px 10px;
  }
  summary {
    font-weight: bold;
    cursor: pointer;
    color: #dc3545;
  }
  .step-title {
    font-weight: bold;
    font-size: 1.15em;
    margin: 18px 0 8px 0;
    color: #dc3545;
  }
  .info-box {
    background: #d1ecf1;
    border: 1px solid #bee5eb;
    border-radius: 4px;
    padding: 15px;
    margin-bottom: 20px;
    color: #0c5460;
  }
  .alt-type-btn {
    background: #fce8e6;
    color: #dc3545;
    border: 1px solid #dc3545;
    border-radius: 4px;
    padding: 6px 12px;
    font-weight: bold;
    cursor: pointer;
  }
  .alt-type-btn.active {
    background: #dc3545;
    color: #fff;
  }
</style>
</head>
<body>

<a href="index.html" class="back-button">‚Üê Retour au menu principal</a>

<div class="lang-switch">
  <div>
    <span>Site :</span>
    <button id="site-fr" class="active" onclick="setSiteLang('fr')" type="button">Fran√ßais</button>
    <button id="site-en" onclick="setSiteLang('en')" type="button">English</button>
  </div>
  <div>
    <span>Com radio :</span>
    <button id="comm-fr" onclick="setCommLang('fr')" type="button">Fran√ßais</button>
    <button id="comm-en" class="active" onclick="setCommLang('en')" type="button">English</button>
  </div>
</div>

<div class="options-switch">
  <div>
    <span>Type de vol :</span>
    <button id="flight-vfr" onclick="setFlightType('vfr')" type="button">VFR</button>
    <button id="flight-ifr" class="active" onclick="setFlightType('ifr')" type="button">IFR</button>
  </div>
  <div>
    <span>Cartes :</span>
    <button id="charts-updated" onclick="setChartsStatus('updated')" type="button">√Ä jour</button>
    <button id="charts-outdated" class="active" onclick="setChartsStatus('outdated')" type="button">Pas √† jour</button>
  </div>
</div>

<h1 id="main-title">Communications ATC - Guide des phrases radio VFR</h1>

<div class="info-box">
  <strong>‚ÑπÔ∏è Information importante :</strong><br>
  <span id="info-text">Les communications ATC suivent des proc√©dures strictes. Utilisez toujours les phrases officielles et respectez les instructions du contr√¥leur. En cas de doute, n'h√©sitez pas √† demander des clarifications.</span>
</div>

<form id="atcForm" onsubmit="generatePhrases(event)">
  <label for="callsign" data-fr="Callsign (optionnel)" data-en="Callsign (optional)">Callsign (optionnel)</label>
  <input type="text" id="callsign" name="callsign" placeholder="Ex: Victor Juliet Zero Five" />

  <label for="departure" data-fr="D√©part (nom de l'a√©roport)" data-en="Departure (airport name)">D√©part (nom de l'a√©roport)</label>
  <input type="text" id="departure" name="departure" required placeholder="Ex: Paris Charles-de-Gaulle" />

  <label for="arrival" data-fr="Arriv√©e (nom de l'a√©roport)" data-en="Arrival (airport name)">Arriv√©e (nom de l'a√©roport)</label>
  <input type="text" id="arrival" name="arrival" required placeholder="Ex: Paris Orly" />

  <label for="runwayDep" data-fr="Piste d√©part" data-en="Departure runway">Piste d√©part</label>
  <input type="text" id="runwayDep" name="runwayDep" required placeholder="Ex: 27" />

  <label for="runwayArr" data-fr="Piste arriv√©e" data-en="Arrival runway">Piste arriv√©e</label>
  <input type="text" id="runwayArr" name="runwayArr" required placeholder="Ex: 09" />

  <label for="degree" data-fr="Cap (degr√©) - optionnel" data-en="Heading (degree) - optional">Cap (degr√©) - optionnel</label>
  <input type="number" id="degree" name="degree" placeholder="Ex: 045 (laissez vide si inconnu)" min="0" max="359" />

  <label for="altitude" data-fr="Altitude (pieds) - optionnel" data-en="Altitude (feet) - optional">Altitude (pieds) - optionnel</label>
  <input type="number" id="altitude" name="altitude" placeholder="Ex: 3500 (laissez vide si inconnue)" />

  <div>
    <label data-fr="Type d'altitude" data-en="Altitude type">Type d'altitude</label>
    <div style="display: flex; gap: 10px; margin-top: 5px;">
      <button type="button" id="alt-type-feet" class="alt-type-btn active" onclick="setAltitudeType('feet')" data-fr="Altitude (pieds)" data-en="Altitude (feet)">Altitude (pieds)</button>
      <button type="button" id="alt-type-fl" class="alt-type-btn" onclick="setAltitudeType('fl')" data-fr="Flight Level" data-en="Flight Level">Flight Level</button>
    </div>
  </div>

  <label for="leftRight" data-fr="Left or Right (downwind)" data-en="Left or Right (downwind)">Left or Right (downwind)</label>
  <select id="leftRight" name="leftRight" required>
    <option value="left" data-fr="Left" data-en="Left">Left</option>
    <option value="right" data-fr="Right" data-en="Right">Right</option>
  </select>

  <label for="parking" data-fr="Place de parking √† l'arriv√©e - optionnel" data-en="Arrival parking spot - optional">Place de parking √† l'arriv√©e - optionnel</label>
  <input type="text" id="parking" name="parking" placeholder="Ex: G23 (laissez vide si inconnu)" />

  <label for="squawk" data-fr="Code transpondeur (si connu)" data-en="Squawk code (if known)">Code transpondeur (si connu)</label>
  <input type="text" id="squawk" name="squawk" placeholder="Ex: 1200" maxlength="4" />

  <button type="submit" data-fr="G√©n√©rer les phrases ATC" data-en="Generate ATC phrases">G√©n√©rer les phrases ATC</button>
</form>

<div id="output" aria-live="polite"></div>

<script>
let siteLang = 'fr';
let commLang = 'en';
let flightType = 'ifr';
let chartsStatus = 'outdated';
let altitudeType = 'feet';

const infoTexts = {
  fr: {
    vfr_updated: "Communications VFR avec ATC. Utilisez les phrases officielles et respectez les instructions du contr√¥leur. En cas de doute, demandez des clarifications.",
    vfr_outdated: "Communications VFR avec ATC - cartes non √† jour. Privil√©giez les demandes de caps directs plut√¥t que les points de navigation. Signalez vos cartes non mises √† jour.",
    ifr_updated: "Communications IFR avec ATC. Proc√©dures strictes obligatoires. Respectez exactement les clairances et les altitudes assign√©es. Utilisez la phras√©ologie standard.",
    ifr_outdated: "Communications IFR avec ATC - cartes non √† jour. ATTENTION : Signalez imm√©diatement vos cartes obsol√®tes. Demandez des vecteurs radar ou caps directs."
  },
  en: {
    vfr_updated: "VFR communications with ATC. Use official phraseology and follow controller instructions. When in doubt, ask for clarification.",
    vfr_outdated: "VFR communications with ATC - charts not current. Prefer direct heading requests over navigation points. Report your outdated charts.",
    ifr_updated: "IFR communications with ATC. Strict procedures mandatory. Follow clearances and assigned altitudes exactly. Use standard phraseology.",
    ifr_outdated: "IFR communications with ATC - charts not current. WARNING: Report outdated charts immediately. Request radar vectors or direct headings."
  }
};

const explanations = {
  fr: {
    vfr_updated: [
      "Premier contact avec la tour de contr√¥le pour demande de d√©part VFR.",
      "R√©ponse √† l'autorisation de d√©part et confirmation.",
      "Demande de roulage vers la piste.",
      "Demande de d√©collage imm√©diat.",
      "Contact avec l'approche/d√©part apr√®s d√©collage.",
      "Demande de changement d'altitude.",
      "Contact avec le centre de contr√¥le en route.",
      "Demande de cap direct au lieu d'un point de navigation.",
      "Premier contact avec l'approche de destination.",
      "Demande d'approche directe.",
      "Int√©gration dans le circuit d'a√©rodrome.",
      "Base leg dans le circuit.",
      "Finale avec clearance d'atterrissage.",
      "Lib√©ration de piste et roulage au parking.",
      "Test radio.",
      "Demande de r√©p√©tition (Say again).",
      "Demande de parler plus lentement.",
      "Confirmation de r√©ception d'instructions.",
      "Report de position en route.",
      "Demande de vecteur radar.",
      "Ident transpondeur.",
      "Changement de fr√©quence.",
      "Demande d'urgence priorit√©.",
      "PAN PAN (urgence non vitale).",
      "MAYDAY (urgence vitale)."
    ],
    vfr_outdated: [
      "Premier contact VFR - signaler cartes non √† jour.",
      "R√©ponse √† l'autorisation avec mention cartes obsol√®tes.",
      "Demande de roulage vers la piste.",
      "Demande de d√©collage imm√©diat.",
      "Contact d√©part - cartes non √† jour, demande vecteurs.",
      "Demande de changement d'altitude.",
      "Contact centre - demande caps directs (cartes obsol√®tes).",
      "Demande cap direct - cartes non mises √† jour.",
      "Contact approche - signaler cartes obsol√®tes.",
      "Demande approche directe - cartes non √† jour.",
      "Int√©gration circuit - demande guidage.",
      "Base leg avec demande de confirmation.",
      "Finale avec clearance d'atterrissage.",
      "Lib√©ration de piste et roulage au parking.",
      "Test radio.",
      "Demande de r√©p√©tition (Say again).",
      "Demande de parler plus lentement.",
      "Confirmation de r√©ception d'instructions.",
      "Report de position avec demande guidage.",
      "Demande vecteur radar (cartes obsol√®tes).",
      "Ident transpondeur.",
      "Changement de fr√©quence.",
      "Demande d'urgence priorit√©.",
      "PAN PAN (urgence non vitale).",
      "MAYDAY (urgence vitale)."
    ],
    ifr_updated: [
      "Demande de clairance IFR au d√©part.",
      "Confirmation clairance IFR re√ßue.",
      "Demande de roulage avec clairance IFR.",
      "Pr√™t pour d√©collage IFR.",
      "Contact d√©part apr√®s d√©collage IFR.",
      "Demande changement niveau de vol.",
      "Contact centre en route IFR.",
      "Demande routage direct (d√©viation plan de vol).",
      "Contact approche IFR destination.",
      "Demande approche aux instruments.",
      "Confirmation approche assign√©e.",
      "Intercept localizer ou final.",
      "Finale approche aux instruments.",
      "Atterrissage et lib√©ration de piste.",
      "Test radio.",
      "Demande de r√©p√©tition (Say again).",
      "Demande de parler plus lentement.",
      "Confirmation de r√©ception d'instructions.",
      "Report obligatoire de position IFR.",
      "Demande vecteur radar IFR.",
      "Ident transpondeur.",
      "Changement de fr√©quence.",
      "Demande d'urgence priorit√©.",
      "PAN PAN (urgence non vitale).",
      "MAYDAY (urgence vitale)."
    ],
    ifr_outdated: [
      "Demande clairance IFR - cartes NON √Ä JOUR.",
      "Confirmation clairance avec signalement cartes obsol√®tes.",
      "Demande roulage - cartes non mises √† jour.",
      "Pr√™t d√©collage IFR - cartes obsol√®tes signal√©es.",
      "Contact d√©part IFR - URGENT : cartes non √† jour.",
      "Demande changement niveau avec cartes obsol√®tes.",
      "Contact centre - CARTES NON √Ä JOUR - demande vecteurs.",
      "URGENT : demande cap direct - cartes obsol√®tes.",
      "Contact approche IFR - CARTES OBSOL√àTES.",
      "Demande vecteurs radar - cartes non √† jour.",
      "Demande guidage complet - cartes obsol√®tes.",
      "Demande vecteurs pour finale - cartes non √† jour.",
      "Finale avec guidage radar - cartes obsol√®tes.",
      "Atterrissage et demande guidage au sol.",
      "Test radio.",
      "Demande de r√©p√©tition (Say again).",
      "Demande de parler plus lentement.",
      "Confirmation de r√©ception d'instructions.",
      "Report position avec demande vecteurs urgents.",
      "URGENT : vecteur radar - cartes obsol√®tes.",
      "Ident transpondeur.",
      "Changement de fr√©quence.",
      "Demande d'urgence priorit√©.",
      "PAN PAN (urgence non vitale).",
      "MAYDAY (urgence vitale)."
    ]
  },
  en: {
    vfr_updated: [
      "Initial contact with tower for VFR departure clearance.",
      "Response to departure clearance and confirmation.",
      "Request for taxi to runway.",
      "Request for immediate takeoff.",
      "Contact with approach/departure after takeoff.",
      "Request for altitude change.",
      "Contact with area control center enroute.",
      "Request for direct heading instead of navigation point.",
      "Initial contact with destination approach.",
      "Request for direct approach.",
      "Integration into airport circuit.",
      "Base leg in the circuit.",
      "Final with landing clearance.",
      "Runway vacation and taxi to parking.",
      "Radio check.",
      "Request for repetition (Say again).",
      "Request to speak slower.",
      "Confirmation of received instructions.",
      "Position report enroute.",
      "Request for radar vector.",
      "Transponder ident.",
      "Frequency change.",
      "Request for emergency priority.",
      "PAN PAN (non-vital emergency).",
      "MAYDAY (vital emergency)."
    ],
    vfr_outdated: [
      "Initial VFR contact - report charts not current.",
      "Clearance response mentioning outdated charts.",
      "Request for taxi to runway.",
      "Request for immediate takeoff.",
      "Departure contact - charts not current, request vectors.",
      "Request for altitude change.",
      "Center contact - request direct headings (charts outdated).",
      "Request direct heading - charts not updated.",
      "Approach contact - report charts outdated.",
      "Request direct approach - charts not current.",
      "Circuit integration - request guidance.",
      "Base leg with confirmation request.",
      "Final with landing clearance.",
      "Runway vacation and taxi to parking.",
      "Radio check.",
      "Request for repetition (Say again).",
      "Request to speak slower.",
      "Confirmation of received instructions.",
      "Position report with guidance request.",
      "Request radar vector (charts outdated).",
      "Transponder ident.",
      "Frequency change.",
      "Request for emergency priority.",
      "PAN PAN (non-vital emergency).",
      "MAYDAY (vital emergency)."
    ],
    ifr_updated: [
      "Request for IFR clearance at departure.",
      "IFR clearance confirmation received.",
      "Request for taxi with IFR clearance.",
      "Ready for IFR takeoff.",
      "Departure contact after IFR takeoff.",
      "Request flight level change.",
      "Center contact enroute IFR.",
      "Request direct routing (flight plan deviation).",
      "IFR approach contact at destination.",
      "Request instrument approach.",
      "Confirmation of assigned approach.",
      "Intercept localizer or final.",
      "Final instrument approach.",
      "Landing and runway vacation.",
      "Radio check.",
      "Request for repetition (Say again).",
      "Request to speak slower.",
      "Confirmation of received instructions.",
      "Mandatory IFR position report.",
      "Request IFR radar vector.",
      "Transponder ident.",
      "Frequency change.",
      "Request for emergency priority.",
      "PAN PAN (non-vital emergency).",
      "MAYDAY (vital emergency)."
    ],
    ifr_outdated: [
      "Request IFR clearance - charts NOT CURRENT.",
      "Clearance confirmation reporting outdated charts.",
      "Request taxi - charts not updated.",
      "Ready IFR takeoff - outdated charts reported.",
      "IFR departure contact - URGENT: charts not current.",
      "Request level change with outdated charts.",
      "Center contact - CHARTS NOT CURRENT - request vectors.",
      "URGENT: request direct heading - outdated charts.",
      "IFR approach contact - CHARTS OUTDATED.",
      "Request radar vectors - charts not current.",
      "Request full guidance - charts outdated.",
      "Request vectors to final - charts not current.",
      "Final with radar guidance - charts outdated.",
      "Landing and request ground guidance.",
      "Radio check.",
      "Request for repetition (Say again).",
      "Request to speak slower.",
      "Confirmation of received instructions.",
      "Position report requesting urgent vectors.",
      "URGENT: radar vector - charts outdated.",
      "Transponder ident.",
      "Frequency change.",
      "Request for emergency priority.",
      "PAN PAN (non-vital emergency).",
      "MAYDAY (vital emergency)."
    ]
  }
};

const phrases = {
  fr: [
    // Contact initial d√©part
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let base = `Tour ${dep}, ${callsign || "Victor Juliet Zero Five"}, ${flightType.toUpperCase()} au parking [position], destination ${arr}, demande autorisation de d√©part.`;
      if (chartsStatus === 'outdated') base += ` Attention : cartes non √† jour.`;
      return `<span class="phrase">${base}</span>`;
    },
    // R√©ponse autorisation
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "niveau demand√©";
      let base = `${callsign || "Victor Juliet Zero Five"}, autoris√© ${flightType.toUpperCase()} vers ${arr}, ${altText}, transpondeur ${squawk || "1200"}, rappelez pr√™t pour roulage.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Demande roulage
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let base = `Tour ${dep}, ${callsign || "Victor Juliet Zero Five"}, pr√™t pour roulage piste ${rDep}, destination ${arr}.`;
      if (flightType === 'ifr') base += ` Plan de vol IFR activ√©.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Pr√™t d√©collage
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${dep}, ${callsign || "Victor Juliet Zero Five"}, pr√™t pour d√©collage imm√©diat piste ${rDep}.</span>`,
    // Contact d√©part
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "niveau autoris√©";
      let base = `D√©part ${dep}, ${callsign || "Victor Juliet Zero Five"}, d√©coll√© piste ${rDep}, mont√©e ${altText}, ${flightType.toUpperCase()} vers ${arr}.`;
      if (chartsStatus === 'outdated' && flightType === 'ifr') base += ` URGENT : cartes non √† jour, demande vecteurs radar.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Demande changement altitude
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let reqText = alt ? "mont√©e " + (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "assignation d'altitude";
      return `<span class="phrase">D√©part ${dep}, ${callsign || "Victor Juliet Zero Five"}, demande ${reqText}.</span>`;
    },
    // Contact centre
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "niveau actuel";
      let base = `Centre, ${callsign || "Victor Juliet Zero Five"}, ${altText}, ${flightType.toUpperCase()} de ${dep} vers ${arr}.`;
      if (chartsStatus === 'outdated') base += ` Cartes non √† jour, demande vecteurs.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Demande cap direct
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let capText = deg ? "cap " + deg + "¬∞ direct" : "cap direct";
      let reason = chartsStatus === 'outdated' ? " (cartes non √† jour)" : " au lieu du point de navigation";
      return `<span class="phrase">Centre, ${callsign || "Victor Juliet Zero Five"}, demande ${capText}${reason}.</span>`;
    },
    // Contact approche
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "niveau actuel";
      let base = `Approche ${arr}, ${callsign || "Victor Juliet Zero Five"}, ${altText}, [position], demande approche ${flightType.toUpperCase()} ${arr}.`;
      if (chartsStatus === 'outdated') base += ` Cartes obsol√®tes, demande guidage complet.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Demande approche directe
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Approche ${arr}, ${callsign || "Victor Juliet Zero Five"}, demande approche directe piste ${rArr}.</span>`,
    // Int√©gration circuit
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${arr}, ${callsign || "Victor Juliet Zero Five"}, int√©gration vent ${lr === "left" ? "gauche" : "droite"} piste ${rArr}.</span>`,
    // Base leg
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${arr}, ${callsign || "Victor Juliet Zero Five"}, base piste ${rArr}.</span>`,
    // Finale
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${arr}, ${callsign || "Victor Juliet Zero Five"}, finale piste ${rArr}, demande clearance atterrissage.</span>`,
    // Lib√©ration piste
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let parkingText = parking ? " parking " + parking : " au parking";
      return `<span class="phrase">Tour ${arr}, ${callsign || "Victor Juliet Zero Five"}, piste ${rArr} d√©gag√©e, demande roulage${parkingText}.</span>`;
    },
    // Communications g√©n√©rales...
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${dep}, ${callsign || "Victor Juliet Zero Five"}, test radio.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, say again please.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, speak slower please.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, Roger, message re√ßu.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " pieds") : "niveau actuel";
      return `<span class="phrase">Centre, ${callsign || "Victor Juliet Zero Five"}, position [position], ${altText}, estim√© ${arr} dans [temps].</span>`;
    },
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Approche ${arr}, ${callsign || "Victor Juliet Zero Five"}, demande vecteur radar pour l'approche.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, ident.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, changement fr√©quence [fr√©quence], au revoir.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">Tour ${dep}, ${callsign || "Victor Juliet Zero Five"}, demande priorit√© pour [raison].</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">PAN PAN, PAN PAN, PAN PAN, ${callsign || "Victor Juliet Zero Five"}, [nature du probl√®me], position [position], demande assistance.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">MAYDAY, MAYDAY, MAYDAY, ${callsign || "Victor Juliet Zero Five"}, [urgence vitale], position [position], [nombre de personnes] personnes √† bord.</span>`
  ],
  en: [
    // Initial departure contact
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let base = `${dep} Tower, ${callsign || "Victor Juliet Zero Five"}, ${flightType.toUpperCase()} at parking [position], destination ${arr}, request departure clearance.`;
      if (chartsStatus === 'outdated') base += ` Charts not current.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Clearance response
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " feet") : "requested level";
      return `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, cleared ${flightType.toUpperCase()} to ${arr}, ${altText}, squawk ${squawk || "1200"}, report ready for taxi.</span>`;
    },
    // Taxi request
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let base = `${dep} Tower, ${callsign || "Victor Juliet Zero Five"}, ready for taxi runway ${rDep}, destination ${arr}.`;
      if (flightType === 'ifr') base += ` IFR flight plan activated.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Ready for takeoff
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${dep} Tower, ${callsign || "Victor Juliet Zero Five"}, ready for immediate takeoff runway ${rDep}.</span>`,
    // Departure contact
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " feet") : "cleared level";
      let base = `${dep} Departure, ${callsign || "Victor Juliet Zero Five"}, airborne runway ${rDep}, climbing ${altText}, ${flightType.toUpperCase()} to ${arr}.`;
      if (chartsStatus === 'outdated' && flightType === 'ifr') base += ` URGENT: charts not current, request radar vectors.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Altitude change request
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let reqText = alt ? "climb " + (altType === 'fl' ? 'FL' + alt : alt + " feet") : "altitude assignment";
      return `<span class="phrase">${dep} Departure, ${callsign || "Victor Juliet Zero Five"}, request ${reqText}.</span>`;
    },
    // Center contact
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " feet") : "current level";
      let base = `Center, ${callsign || "Victor Juliet Zero Five"}, ${altText}, ${flightType.toUpperCase()} from ${dep} to ${arr}.`;
      if (chartsStatus === 'outdated') base += ` Charts not current, request vectors.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Direct heading request
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let headingText = deg ? "heading " + deg + " degrees direct" : "direct heading";
      let reason = chartsStatus === 'outdated' ? " (charts not current)" : " instead of navigation point";
      return `<span class="phrase">Center, ${callsign || "Victor Juliet Zero Five"}, request ${headingText}${reason}.</span>`;
    },
    // Approach contact
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " feet") : "current level";
      let base = `${arr} Approach, ${callsign || "Victor Juliet Zero Five"}, ${altText}, [position], request ${flightType.toUpperCase()} approach ${arr}.`;
      if (chartsStatus === 'outdated') base += ` Charts outdated, request full guidance.`;
      return `<span class="phrase">${base}</span>`;
    },
    // Direct approach request
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${arr} Approach, ${callsign || "Victor Juliet Zero Five"}, request direct approach runway ${rArr}.</span>`,
    // Circuit integration
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${arr} Tower, ${callsign || "Victor Juliet Zero Five"}, entering ${lr} downwind runway ${rArr}.</span>`,
    // Base leg
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${arr} Tower, ${callsign || "Victor Juliet Zero Five"}, turning base runway ${rArr}.</span>`,
    // Final
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${arr} Tower, ${callsign || "Victor Juliet Zero Five"}, final runway ${rArr}, request landing clearance.</span>`,
    // Runway vacation
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let parkingText = parking ? " parking " + parking : " parking";
      return `<span class="phrase">${arr} Tower, ${callsign || "Victor Juliet Zero Five"}, runway ${rArr} vacated, request taxi to${parkingText}.</span>`;
    },
    // General communications...
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${dep} Tower, ${callsign || "Victor Juliet Zero Five"}, radio check.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, say again please.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, speak slower please.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, Roger, message received.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => {
      let altText = alt ? (altType === 'fl' ? 'FL' + alt : alt + " feet") : "current level";
      return `<span class="phrase">Center, ${callsign || "Victor Juliet Zero Five"}, position [position], ${altText}, estimating ${arr} in [time].</span>`;
    },
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${arr} Approach, ${callsign || "Victor Juliet Zero Five"}, request radar vector for approach.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, ident.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${callsign || "Victor Juliet Zero Five"}, frequency change to [frequency], good day.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">${dep} Tower, ${callsign || "Victor Juliet Zero Five"}, request priority for [reason].</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">PAN PAN, PAN PAN, PAN PAN, ${callsign || "Victor Juliet Zero Five"}, [nature of problem], position [position], request assistance.</span>`,
    (dep, arr, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altType, flightType, chartsStatus) => `<span class="phrase">MAYDAY, MAYDAY, MAYDAY, ${callsign || "Victor Juliet Zero Five"}, [vital emergency], position [position], [number] souls on board.</span>`
  ]
};

const stepTitles = {
  fr: [
    () => `<div class="step-title">üõ´ D√©part</div>`,
    null, null, null,
    () => `<div class="step-title">‚úàÔ∏è En route</div>`,
    null, null, null,
    () => `<div class="step-title">üõ¨ Arriv√©e</div>`,
    null, null, null, null, null,
    () => `<div class="step-title">üìû Communications g√©n√©rales</div>`,
    null, null, null, null, null, null, null,
    () => `<div class="step-title">üö® Urgences</div>`,
    null, null
  ],
  en: [
    () => `<div class="step-title">üõ´ Departure</div>`,
    null, null, null,
    () => `<div class="step-title">‚úàÔ∏è Enroute</div>`,
    null, null, null,
    () => `<div class="step-title">üõ¨ Arrival</div>`,
    null, null, null, null, null,
    () => `<div class="step-title">üìû General communications</div>`,
    null, null, null, null, null, null, null,
    () => `<div class="step-title">üö® Emergencies</div>`,
    null, null
  ]
};

function setAltitudeType(type) {
  altitudeType = type;
  document.getElementById('alt-type-feet').classList.toggle('active', type === 'feet');
  document.getElementById('alt-type-fl').classList.toggle('active', type === 'fl');
  
  // R√©affiche les phrases si d√©j√† g√©n√©r√©es
  if (document.getElementById('output').innerHTML.trim()) {
    generatePhrases();
  }
}

function setFlightType(type) {
  flightType = type;
  document.getElementById('flight-vfr').classList.toggle('active', type === 'vfr');
  document.getElementById('flight-ifr').classList.toggle('active', type === 'ifr');
  updateInfoText();
  updateTitle();
  
  // R√©affiche les phrases si d√©j√† g√©n√©r√©es
  if (document.getElementById('output').innerHTML.trim()) {
    generatePhrases();
  }
}

function setChartsStatus(status) {
  chartsStatus = status;
  document.getElementById('charts-updated').classList.toggle('active', status === 'updated');
  document.getElementById('charts-outdated').classList.toggle('active', status === 'outdated');
  updateInfoText();
  
  // R√©affiche les phrases si d√©j√† g√©n√©r√©es
  if (document.getElementById('output').innerHTML.trim()) {
    generatePhrases();
  }
}

function updateInfoText() {
  const key = `${flightType}_${chartsStatus}`;
  document.getElementById('info-text').textContent = infoTexts[siteLang][key];
}

function updateTitle() {
  const baseTitle = siteLang === 'fr' ? 
    "Communications ATC - Guide des phrases radio " : 
    "ATC Communications - Radio Phrase Guide ";
  document.getElementById('main-title').textContent = baseTitle + flightType.toUpperCase();
}

function setSiteLang(lang) {
  siteLang = lang;
  document.getElementById('site-fr').classList.toggle('active', lang === 'fr');
  document.getElementById('site-en').classList.toggle('active', lang === 'en');
  updateTitle();
  updateInfoText();
  
  // Labels et placeholders
  document.querySelectorAll('label').forEach(label => {
    if (label.dataset[lang]) label.textContent = label.dataset[lang];
  });
  document.querySelector('button[type="submit"]').textContent = document.querySelector('button[type="submit"]').dataset[lang];
  
  // Select options
  document.querySelectorAll('#leftRight option').forEach(opt => {
    if (opt.dataset[lang]) opt.textContent = opt.dataset[lang];
  });
  
  // Altitude type buttons
  document.querySelectorAll('.alt-type-btn').forEach(btn => {
    if (btn.dataset[lang]) btn.textContent = btn.dataset[lang];
  });
  
  // R√©affiche les phrases si d√©j√† g√©n√©r√©es
  if (document.getElementById('output').innerHTML.trim()) {
    generatePhrases();
  }
}

function setCommLang(lang) {
  commLang = lang;
  document.getElementById('comm-fr').classList.toggle('active', lang === 'fr');
  document.getElementById('comm-en').classList.toggle('active', lang === 'en');
  
  // R√©affiche les phrases si d√©j√† g√©n√©r√©es
  if (document.getElementById('output').innerHTML.trim()) {
    generatePhrases();
  }
}

function generatePhrases(event) {
  if(event) event.preventDefault();

  let callsign = document.getElementById("callsign").value.trim();
  const depName = document.getElementById("departure").value.trim();
  const arrName = document.getElementById("arrival").value.trim();
  const rDep = document.getElementById("runwayDep").value.trim();
  const rArr = document.getElementById("runwayArr").value.trim();
  const alt = document.getElementById("altitude").value.trim();
  const deg = document.getElementById("degree").value.trim();
  const lr = document.getElementById("leftRight").value;
  const parking = document.getElementById("parking").value.trim();
  const squawk = document.getElementById("squawk").value.trim();

  const key = `${flightType}_${chartsStatus}`;
  const phraseList = phrases[commLang];
  const explainList = explanations[siteLang][key];
  const stepList = stepTitles[siteLang];

  let html = "";
  for(let i = 0; i < phraseList.length; i++) {
    if (stepList[i]) {
      html += stepList[i]();
    }
    if (!stepList[i]) {
      html += `<details><summary>${explainList[i]}</summary>${phraseList[i](depName, arrName, rDep, rArr, alt, deg, lr, parking, callsign, squawk, altitudeType, flightType, chartsStatus)}</details>`;
    }
  }

  document.getElementById("output").innerHTML = html;
}

// Initialisation
setSiteLang('fr');
setCommLang('en');
setFlightType('ifr');
setChartsStatus('outdated');
setAltitudeType('feet');
</script>

</body>
</html>
